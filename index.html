<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AIX ‚Äì Global Intelligence</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont;
      background: #0b0f14;
      color: #e6edf3;
      display: flex;
      height: 100vh;
    }

    .sidebar {
      width: 260px;
      background: #0f1720;
      border-right: 1px solid #1f2937;
      padding: 16px;
      box-sizing: border-box;
    }

    .sidebar h2 {
      margin: 0 0 12px;
      font-size: 18px;
      color: #38bdf8;
    }

    .topic {
      padding: 8px;
      border-radius: 6px;
      cursor: pointer;
      margin-bottom: 6px;
      background: #111827;
    }

    .topic.active {
      background: #1d4ed8;
    }

    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .header {
      padding: 12px 16px;
      border-bottom: 1px solid #1f2937;
      background: #020617;
      font-weight: 600;
    }

    .chat {
      flex: 1;
      padding: 16px;
      overflow-y: auto;
    }

    .msg {
      margin-bottom: 14px;
      max-width: 80%;
      line-height: 1.5;
      white-space: pre-wrap;
    }

    .user {
      background: #1e293b;
      padding: 10px;
      border-radius: 10px;
      margin-left: auto;
    }

    .aix {
      background: #020617;
      border: 1px solid #1f2937;
      padding: 10px;
      border-radius: 10px;
    }

    .output {
      margin-top: 8px;
      font-size: 13px;
      color: #93c5fd;
    }

    .input-bar {
      display: flex;
      padding: 10px;
      border-top: 1px solid #1f2937;
      background: #020617;
    }

    textarea {
      flex: 1;
      resize: none;
      padding: 10px;
      border-radius: 8px;
      border: none;
      outline: none;
      background: #020617;
      color: #e6edf3;
      height: 48px;
    }

    button {
      margin-left: 10px;
      padding: 0 18px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      background: #2563eb;
      color: white;
      font-weight: 600;
    }

    a {
      color: #38bdf8;
    }
  </style>
</head>

<body>
  <div class="sidebar">
    <h2>AIX Topics</h2>
    <div id="topics"></div>
    <button onclick="newTopic()">+ New Topic</button>
  </div>

  <div class="main">
    <div class="header">
      AIX ‚Äì Speak. Decide. Execute.
    </div>

    <div id="chat" class="chat"></div>

    <div class="input-bar">
      <textarea id="input" placeholder="‡§¨‡•ã‡§≤‡§æ ‡§¨‡•â‡§∏‚Ä¶ (Marathi / Hindi / English)"></textarea>
      <button onclick="send()">Send</button>
    </div>
  </div>

<script>
const BACKEND_URL = "https://boss-aix-backend-nai6.onrender.com/api/aix/chat";
// ‚¨ÜÔ∏è ‡§ú‡§∞ backend URL ‡§¨‡§¶‡§≤‡§≤‡§æ ‡§Ö‡§∏‡•á‡§≤ ‡§§‡§∞ ‡§á‡§•‡•á ‡§¨‡§¶‡§≤‡§æ

let sessionId = "topic-1";
let topics = { "topic-1": "General" };

function renderTopics() {
  const el = document.getElementById("topics");
  el.innerHTML = "";
  Object.keys(topics).forEach(id => {
    const div = document.createElement("div");
    div.className = "topic" + (id === sessionId ? " active" : "");
    div.innerText = topics[id];
    div.onclick = () => switchTopic(id);
    el.appendChild(div);
  });
}

function newTopic() {
  const id = "topic-" + Date.now();
  topics[id] = "New Topic";
  sessionId = id;
  document.getElementById("chat").innerHTML = "";
  renderTopics();
}

function switchTopic(id) {
  sessionId = id;
  document.getElementById("chat").innerHTML = "";
  renderTopics();
}

function addMsg(text, cls, extraHtml = "") {
  const chat = document.getElementById("chat");
  const div = document.createElement("div");
  div.className = "msg " + cls;
  div.innerHTML = text + extraHtml;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

async function send() {
  const input = document.getElementById("input");
  const text = input.value.trim();
  if (!text) return;

  input.value = "";
  addMsg(text, "user");

  try {
    const res = await fetch(BACKEND_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        message: text,
        sessionId
      })
    });

    const data = await res.json();

    let extra = "";
    if (data.proof || data.output || data.file) {
      const link = data.proof || data.output || data.file;
      extra = `<div class="output">üîó <a href="${link}" target="_blank">View / Download Output</a></div>`;
    }

    addMsg(data.reply?.text || data.reply || "No reply", "aix", extra);

  } catch (e) {
    addMsg("‚ùå Backend ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§ù‡§æ‡§≤‡§æ ‡§®‡§æ‡§π‡•Ä.\n" + e.message, "aix");
  }
}

renderTopics();
</script>
</body>
</html>
